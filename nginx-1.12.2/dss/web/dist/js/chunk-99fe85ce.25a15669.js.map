{"version":3,"sources":["webpack:///./src/assets/styles/login.scss?e04b","webpack:///./src/js/view/login/index.vue?5033","webpack:///src/js/view/login/index.vue","webpack:///./src/js/view/login/index.vue?9cf0","webpack:///./src/js/view/login/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","$event","type","indexOf","_k","keyCode","key","stopPropagation","preventDefault","handleSubmit","ref","attrs","loginForm","ruleInline","_v","_s","$t","model","value","callback","$$v","$set","expression","rememberUserNameAndPass","loading","staticRenderFns","data","user","password","created","userNameAndPass","split","mounted","userInfo","getIfLogin","methods","api","$refs","name","validate","valid","storage","userName","clearSession","component"],"mappings":"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","file":"js/chunk-99fe85ce.25a15669.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!./login.scss?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!./login.scss?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\",on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.stopPropagation();$event.preventDefault();return _vm.handleSubmit('loginForm')}}},[_c('i',{staticClass:\"login-bg\"}),_c('div',{staticClass:\"login-main\"},[_c('Form',{ref:\"loginForm\",attrs:{\"model\":_vm.loginForm,\"rules\":_vm.ruleInline}},[_c('FormItem',[_c('span',{staticClass:\"login-title\"},[_vm._v(_vm._s(_vm.$t('message.login.loginTitle')))])]),_c('FormItem',{attrs:{\"prop\":\"user\"}},[_c('Input',{attrs:{\"type\":\"text\",\"placeholder\":_vm.$t('message.login.userName'),\"size\":\"large\"},model:{value:(_vm.loginForm.user),callback:function ($$v) {_vm.$set(_vm.loginForm, \"user\", $$v)},expression:\"loginForm.user\"}})],1),_c('FormItem',{attrs:{\"prop\":\"password\"}},[_c('Input',{attrs:{\"type\":\"password\",\"placeholder\":\"请输入密码\",\"size\":\"large\"},model:{value:(_vm.loginForm.password),callback:function ($$v) {_vm.$set(_vm.loginForm, \"password\", $$v)},expression:\"loginForm.password\"}}),_c('Checkbox',{staticClass:\"remember-user-name\",model:{value:(_vm.rememberUserNameAndPass),callback:function ($$v) {_vm.rememberUserNameAndPass=$$v},expression:\"rememberUserNameAndPass\"}},[_vm._v(_vm._s(_vm.$t('message.login.remenber')))])],1),_c('FormItem',[_c('Button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\",\"long\":\"\",\"size\":\"large\",\"shape\":\"circle\"},on:{\"click\":function($event){return _vm.handleSubmit('loginForm')}}},[_vm._v(_vm._s(_vm.$t('message.login.login')))])],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div\n    class=\"login\"\n    @keyup.enter.stop.prevent=\"handleSubmit('loginForm')\">\n    <i class=\"login-bg\"/>\n    <div class=\"login-main\">\n      <Form\n        ref=\"loginForm\"\n        :model=\"loginForm\"\n        :rules=\"ruleInline\">\n        <FormItem>\n          <span class=\"login-title\">{{$t('message.login.loginTitle')}}</span>\n        </FormItem>\n        <FormItem prop=\"user\">\n          <Input\n            v-model=\"loginForm.user\"\n            type=\"text\"\n            :placeholder=\"$t('message.login.userName')\"\n            size=\"large\">\n          </Input>\n        </FormItem>\n        <FormItem prop=\"password\">\n          <Input\n            v-model=\"loginForm.password\"\n            type=\"password\"\n            placeholder=\"请输入密码\"\n            size=\"large\" />\n          <Checkbox\n            v-model=\"rememberUserNameAndPass\"\n            class=\"remember-user-name\"\n            style=\"\">{{$t('message.login.remenber')}}</Checkbox>\n        </FormItem>\n        <FormItem>\n          <Button\n            :loading=\"loading\"\n            type=\"primary\"\n            long\n            size=\"large\"\n            shape=\"circle\"\n            @click=\"handleSubmit('loginForm')\">{{$t('message.login.login')}}</Button>\n        </FormItem>\n      </Form>\n    </div>\n  </div>\n</template>\n<script>\nimport api from '@/js/service/api';\nimport storage from '@/js/helper/storage';\nimport socket from '@js/module/webSocket';\nexport default {\n  data() {\n    return {\n      loading: false,\n      loginForm: {\n        user: '',\n        password: '',\n      },\n      ruleInline: {\n        user: [\n          { required: true, message: this.$t('message.login.userName'), trigger: 'blur' },\n          // {type: 'string', pattern: /^[0-9a-zA-Z\\.\\-_]{4,16}$/, message: '无效的用户名！', trigger: 'change'},\n        ],\n        password: [\n          { required: true, message: this.$t('message.login.password'), trigger: 'blur' },\n          // {type: 'string', pattern: /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,18}$/, message: '请输入6至12位的密码', trigger: 'change'},\n        ],\n      },\n      rememberUserNameAndPass: false,\n    };\n  },\n  created() {\n    let userNameAndPass = storage.get('saveUserNameAndPass', 'local');\n    if (userNameAndPass) {\n      this.rememberUserNameAndPass = true;\n      this.loginForm.user = userNameAndPass.split('&')[0];\n      this.loginForm.password = userNameAndPass.split('&')[1];\n    }\n  },\n  mounted() {\n    // 如果有登录状态，且用户手动跳转到login页，则判断登录态是否过期\n    const userInfo = storage.get('userInfo');\n    if (userInfo) {\n      this.getIfLogin();\n    }\n    socket.methods.close();\n  },\n  methods: {\n    getIfLogin() {\n      api.fetch('/dss/getBaseInfo', 'get').then(() => {\n        this.$router.push('/');\n      }).catch(() => {\n        this.clearSession();\n      });\n    },\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          this.loading = true;\n          if (!this.rememberUserNameAndPass) {\n            storage.remove('saveUserNameAndPass', 'local');\n          }\n          this.loginForm.user = this.loginForm.user.toLocaleLowerCase();\n          const params = {\n            userName: this.loginForm.user,\n            password: this.loginForm.password,\n          };\n          api\n            .fetch(`/user/login`, params)\n            .then((rst) => {\n              this.loading = false;\n              // 保存用户名\n              if (this.rememberUserNameAndPass) {\n                storage.set('saveUserNameAndPass', `${this.loginForm.user}&${this.loginForm.password}`, 'local');\n              }\n              if (rst) {\n                storage.set('userInfo', {\n                  basic: rst,\n                });\n                this.$router.push('/');\n                this.$Message.success(this.$t('message.login.loginSuccess'));\n              }\n            })\n            .catch((err) => {\n              if (this.rememberUserNameAndPass) {\n                storage.set('saveUserNameAndPass', `${this.loginForm.user}&${this.loginForm.password}`, 'local');\n              }\n              if (err.message.indexOf('您已经登录，请不要重复登录') !== -1) {\n                this.$router.push('/');\n              }\n              this.loading = false;\n            });\n        } else {\n          this.$Message.error(this.$t('message.login.vaildFaild'));\n        }\n      });\n    },\n    clearSession() {\n      storage.clear();\n    },\n  },\n};\n</script>\n<style lang=\"scss\" src=\"@assets/styles/login.scss\"></style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1d4ac43d&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"@assets/styles/login.scss?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}