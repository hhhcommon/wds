{"version":3,"sources":["webpack:///./src/assets/styles/workflow.scss?8bf0","webpack:///./src/js/view/workflow/index.vue?9397","webpack:///src/js/view/workflow/index.vue","webpack:///./src/js/view/workflow/index.vue?9f59","webpack:///./src/js/view/workflow/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","index","key","class","active","version","currentVal","name","on","$event","onTabClick","target","currentTarget","isHover","attrs","label","_v","_s","stopPropagation","onTabRemove","_e","directives","rawName","value","expression","ref","refInFor","openWorkflow","query","updateWorkflowList","staticRenderFns","components","Workflow","process","data","indexLabel","h","tabList","close","lastVal","current","watch","oldVal","val","updateProjectCache","mounted","getCache","methods","isIn","params","flowId","push","projectID","splice","wantUpadateList","$route","project","$refs","workflow","fetchFlowData","component"],"mappings":"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","file":"js/chunk-028c2296.f6edf2e5.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!./workflow.scss?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!./workflow.scss?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"workflow-wrap\"},[_c('div',{staticClass:\"workflow-tabs\"},_vm._l((_vm.tabList),function(item,index){return _c('div',{key:index,staticClass:\"workflow-tabs-item\",class:{active: item.version ? (_vm.currentVal.name===item.name && _vm.currentVal.version === item.version) : _vm.currentVal.name===item.name },on:{\"click\":function($event){return _vm.onTabClick(item)},\"mouseenter\":function($event){if($event.target !== $event.currentTarget){ return null; }item.isHover = true},\"mouseleave\":function($event){if($event.target !== $event.currentTarget){ return null; }item.isHover = false}}},[_c('div',{staticClass:\"workflow-tabs-name\",attrs:{\"title\":item.label}},[_vm._v(_vm._s(item.label))]),(item.close)?_c('Icon',{staticClass:\"workflow-tabs-close\",attrs:{\"type\":\"ios-close\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.onTabRemove(item)}}}):_vm._e()],1)}),0),_vm._l((_vm.tabList),function(item,index){return [(item.name === 'index')?_c('Workflow',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.version ? (_vm.currentVal.name===item.name && _vm.currentVal.version === item.version) : _vm.currentVal.name===item.name),expression:\"item.version ? (currentVal.name===item.name && currentVal.version === item.version) : currentVal.name===item.name\"}],key:index,ref:\"workflow\",refInFor:true,on:{\"open-workflow\":_vm.openWorkflow}}):_c('process',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.version ? (_vm.currentVal.name===item.name && _vm.currentVal.version === item.version) : _vm.currentVal.name===item.name),expression:\"item.version ? (currentVal.name===item.name && currentVal.version === item.version) : currentVal.name===item.name\"}],key:index,attrs:{\"query\":item.query},on:{\"updateWorkflowList\":_vm.updateWorkflowList}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"workflow-wrap\">\n    <div class=\"workflow-tabs\">\n      <div\n        v-for=\"(item, index) in tabList\"\n        :key=\"index\"\n        class=\"workflow-tabs-item\"\n        @click=\"onTabClick(item)\"\n        :class=\"{active: item.version ? (currentVal.name===item.name && currentVal.version === item.version) : currentVal.name===item.name }\"\n        @mouseenter.self=\"item.isHover = true\"\n        @mouseleave.self=\"item.isHover = false\">\n        <div\n          :title=\"item.label\"\n          class=\"workflow-tabs-name\">{{ item.label }}</div>\n        <Icon\n          v-if=\"item.close\"\n          type=\"ios-close\"\n          class=\"workflow-tabs-close\"\n          @click.stop=\"onTabRemove(item)\"/>\n      </div>\n    </div>\n    <template v-for=\"(item, index) in tabList\">\n      <Workflow\n        :key=\"index\"\n        ref=\"workflow\"\n        @open-workflow=\"openWorkflow\"\n        v-if=\"item.name === 'index'\"\n        v-show=\"item.version ? (currentVal.name===item.name && currentVal.version === item.version) : currentVal.name===item.name\"></Workflow>\n      <process\n        :key=\"index\"\n        v-else\n        v-show=\"item.version ? (currentVal.name===item.name && currentVal.version === item.version) : currentVal.name===item.name\"\n        :query=\"item.query\"\n        @updateWorkflowList=\"updateWorkflowList\"></process>\n    </template>\n  </div>\n</template>\n<script>\nimport projectDb from '@js/service/db/project.js';\nimport Workflow from '@js/module/workflow';\nimport Process from '@js/module/process';\nimport project from '../../module/project';\nexport default {\n  components: {\n    Workflow: Workflow.component,\n    process: Process.component,\n  },\n  data() {\n    return {\n      indexLabel: (h) => {\n        return h(\"span\", {}, '概览')\n      },\n      tabList: [{\n        name: 'index',\n        label: '概览',\n        isHover: true,\n        close: false,\n        version: 'index'\n      }],\n      currentVal: {name: 'index', version: 'index'},\n      lastVal: null,\n      current: null,\n    };\n  },\n  watch: {\n    'currentVal'(val, oldVal) {\n      this.lastVal = oldVal;\n      this.currentVal = val;\n      this.updateProjectCache();\n    },\n    '$route.query.projectID'() {\n      this.current = {\n        name: 'index',\n        label: '概览',\n        isHover: true,\n        close: false,\n        version: 'index'\n      };\n      this.tabList = [{\n        ...this.current\n      }];\n      this.currentVal = {name: 'index', version: 'index'};\n      this.lastVal = null;\n    }\n  },\n  mounted() {\n    this.getCache();\n  },\n  methods: {\n    openWorkflow(params) {\n      const isIn = this.tabList.find((item) => item.name === params.name && item.version === params.version);\n      if (!isIn || isIn === -1) {\n        this.current = {\n          version: params.version,\n          flowId: params.flowId,\n          label: params.name,\n          name: params.name,\n          query: params,\n          isHover: true,\n          close: true,\n        };\n        this.tabList.push(this.current);\n      }\n      this.lastVal = this.currentVal;\n      this.currentVal = {\n        name: params.name,\n        version: params.version\n      } ;\n      this.updateProjectCache(params.projectID, true);\n    },\n    onTabRemove(item) {\n      const index = this.tabList.findIndex((subitem) => item.name === subitem.name && item.version === subitem.version);\n      this.tabList.splice(index, 1);\n      // 判断删除的是否是当前打开的，不是不用动\n      if (item.name === this.currentVal.name && item.version === this.currentVal.version) {\n        this.currentVal = this.lastVal;\n      }\n      this.updateProjectCache(null, true);\n    },\n    onTabClick(item) {\n      this.lastVal = this.currentVal;\n      this.currentVal = {\n        name: item.name,\n        version: item.version\n      };\n      this.current = item;\n    },\n    async getCache() {\n      const query = this.$route.query;\n      if (query && query.projectID) {\n        const cache = await projectDb.getProjectCache({projectID: query.projectID});\n        if (cache && Number(query.projectID) === Number(cache.projectID)) {\n          this.lastVal = cache.lastVal;\n          if (cache.tabList) {\n            this.currentVal = cache.currentVal;\n            this.tabList = cache.tabList;\n            this.current = cache.tabList.find((item) => {\n              if (this.currentVal.version && item.version) {\n                return (item.name === this.currentVal.name && item.version == this.currentVal.version);\n              } else {\n                return item.name === this.currentVal.name;\n              }\n            });\n          } else {\n            this.current = {\n              name: 'index',\n              label: '概览',\n              isHover: true,\n              close: false,\n              version: 'index'\n            }\n          }\n        }\n      }\n    },\n    updateProjectCache(projectID, wantUpadateList) {\n      const value = {\n        currentVal: this.currentVal,\n        lastVal: this.lastVal,\n      }\n      if (wantUpadateList) {\n        value.tabList = this.tabList;\n      }\n      projectID = projectID || this.$route.query.projectID;\n      projectDb.updateProjectCache({\n        projectID,\n        value,\n      })\n    },\n    updateWorkflowList() {\n      this.$refs.workflow[0].fetchFlowData();\n    }\n  }\n};\n</script>\n<style lang=\"scss\" src=\"@assets/styles/workflow.scss\"></style>\n\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=8b25ff06&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"@assets/styles/workflow.scss?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}